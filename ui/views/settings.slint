import { Button, LineEdit, CheckBox } from "std-widgets.slint";

// Pomocn치 komponenta pro karty statistik (v horn칤 캜치sti spr치vy partner콢)
component FilterCard inherits Rectangle {
    in property <string> label;
    in property <string> count;
    in property <color> count-color: white;
    in property <bool> active: false;
    in property <string> icon;
    callback clicked();

    background: #252525;
    border-radius: 8px;
    border-width: 2px;
    border-color: active ? #2CC985 : #3d3d3d;
    
    animate border-color { duration: 150ms; }

    TouchArea {
        clicked => { root.clicked(); }
        HorizontalLayout {
            padding: 12px; spacing: 15px;
            Text { text: root.icon; vertical-alignment: center; font-size: 22px; }
            VerticalLayout {
                alignment: center;
                Text { text: root.label; color: #888; font-size: 11px; font-weight: 700; }
                Text { text: root.count; color: root.count-color; font-size: 18px; font-weight: 800; }
            }
        }
    }
}

export component SettingsView inherits VerticalLayout {
    // Vlastnosti pro komunikaci s hlavn칤 aplikac칤
    in property <int> db-status-code: 1;
    in property <string> stav-text: "DATAB츼ZE NEN칈 NA캛TENA";
    in property <int> pocet-celkem: 0;
    in property <int> pocet-chybi: 0;

    // Vnit콏n칤 stav pro p콏ep칤n치n칤 pod-z치lo쬰k
    property <int> settings-tab: 0;

    // Hlavn칤 odsazen칤 str치nky, aby obsah nel칤coval s okraji okna
    padding: 25px;
    spacing: 25px;

    // --- 1. HORN칈 P콎EP칈NA캛 (TABS) ---
    HorizontalLayout {
        height: 45px; 
        spacing: 12px; 
        vertical-stretch: 0;
        
        Button { 
            text: "Aktualizace dat"; 
            primary: settings-tab == 0; 
            clicked => { settings-tab = 0; } 
        }
        Button { 
            text: "Datab치ze partner콢"; 
            primary: settings-tab == 1; 
            clicked => { settings-tab = 1; } 
        }
        Button { 
            text: "Obecn칠 nastaven칤"; 
            primary: settings-tab == 2; 
            clicked => { settings-tab = 2; } 
        }
    }

    // --- 2. DYNAMICK칗 OBSAH PODLE VYBRAN칄 Z츼LO콯KY ---
    Rectangle {
        vertical-stretch: 1;
        
        // --- Z츼LO콯KA: AKTUALIZACE (Index 0) ---
        if (settings-tab == 0) : VerticalLayout {
            spacing: 30px;
            alignment: center;

            Text { 
                text: "Stav datab치ze obchodn칤ch partner콢"; 
                color: white; 
                font-size: 20px; 
                font-weight: 700; 
                horizontal-alignment: center; 
            }

            Rectangle {
                height: 120px;
                max-width: 600px;
                background: root.db-status-code == 0 ? #2CC98515 : (root.db-status-code == 2 ? #f39c1215 : #e74c3c15);
                border-color: root.db-status-code == 0 ? #2CC985 : (root.db-status-code == 2 ? #f39c12 : #e74c3c);
                border-width: 2px;
                border-radius: 12px;

                Text {
                    text: root.stav-text;
                    color: parent.border-color;
                    font-size: 22px;
                    font-weight: 900;
                    horizontal-alignment: center;
                    vertical-alignment: center;
                }
            }

            Button { 
                text: "SYNCHRONIZOVAT NYN칈"; 
                height: 55px; 
                max-width: 350px; 
            }
        }

        // --- Z츼LO콯KA: PARTNE콎I (Index 1) ---
        if (settings-tab == 1) : VerticalLayout {
            spacing: 20px;

            // Vyhled치v치n칤 a rychl칠 n치hledy
            HorizontalLayout {
                height: 80px;
                spacing: 20px;
                
                FilterCard { 
                    icon: "游논"; label: "CELKEM V DB"; count: "\{root.pocet-celkem}"; 
                }
                FilterCard { 
                    icon: "丘멆잺"; label: "BEZ SLO콯KY"; count: "\{root.pocet-chybi}"; count-color: #ff4444; 
                }
                
                // Vyhled치vac칤 li코ta - OPRAVENO ZAROVN츼N칈
                Rectangle {
                    horizontal-stretch: 1;
                    background: #252525;
                    border-radius: 8px;
                    border-width: 1px;
                    border-color: #444;
                    
                    HorizontalLayout {
                        padding-left: 15px; 
                        spacing: 12px;
                        alignment: center; // Vertik치ln캩 vycentruje ikonu i LineEdit

                        Text { text: "游댌"; color: #666; font-size: 18px; }
                        
                        LineEdit { 
                            placeholder-text: "Hledat partnera podle n치zvu nebo ID..."; 
                            horizontal-stretch: 1;
                            // vertical-alignment odstran캩n (LineEdit jej nepodporuje)
                        }
                    }
                }
            }

            // Z치hlav칤 seznamu
            Rectangle {
                height: 40px;
                background: #2a2a2a;
                border-radius: 6px;
                HorizontalLayout {
                    padding-left: 20px; padding-right: 20px;
                    Text { text: "STAV"; width: 80px; color: #666; font-size: 11px; font-weight: 800; vertical-alignment: center; }
                    Text { text: "ID"; width: 100px; color: #666; font-size: 11px; font-weight: 800; vertical-alignment: center; }
                    Text { text: "N츼ZEV FIRMY"; color: #666; font-size: 11px; font-weight: 800; vertical-alignment: center; }
                }
            }

            // Placeholder pro tabulku
            Rectangle {
                background: #1e1e1e;
                border-radius: 8px;
                vertical-stretch: 1;
                Text { text: "Seznam partner콢 bude na캜ten z datab치ze..."; color: #444; horizontal-alignment: center; vertical-alignment: center; }
            }
        }

        // --- Z츼LO콯KA: OBECN칄 (Index 2) ---
        if (settings-tab == 2) : VerticalLayout {
            spacing: 25px;
            padding: 10px;

            Text { text: "Syst칠mov치 nastaven칤"; color: white; font-size: 18px; font-weight: 700; }
            
            CheckBox { text: "Povolit automatickou aktualizaci p콏i spu코t캩n칤"; checked: true; }
            CheckBox { text: "Ukl치dat historii import콢 do logu"; checked: true; }

            Rectangle { height: 1px; background: #333; }

            Text { text: "Konfigurace cest (Server / Archiv)"; color: #888; font-size: 13px; }
            
            HorizontalLayout {
                spacing: 10px;
                alignment: center;
                LineEdit { placeholder-text: "Zadejte cestu k archivu..."; horizontal-stretch: 1; }
                Button { text: "Zm캩nit"; width: 100px; }
            }

            Rectangle { vertical-stretch: 1; }
        }
    }
}